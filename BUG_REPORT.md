# ฺฏุฒุงุฑุด ุฌุงูุน ุจุงฺฏโูุง ู ูุดฺฉูุงุช ูพุฑูฺู FlexPro V2

## ๐ด ุจุงฺฏโูุง ุจุญุฑุงู (Critical Bugs)

### 1. ุจุงฺฏ ุฏุฑ Drag & Drop - DietPanel
**ูฺฉุงู:** `src/components/DietPanel.jsx:101-102`
**ูุดฺฉู:** 
```javascript
const oldIndex = parseInt(active.id.split('-')[1]);
const newIndex = parseInt(over.id.split('-')[1]);
```
**ุชูุถุญ:** ุงฺฏุฑ `active.id` ุง `over.id` ูุฑูุช `food-${idx}` ูุฏุงุดุชู ุจุงุดุฏุ `split('-')[1]` ููฺฉู ุงุณุช `undefined` ุจุฑฺฏุฑุฏุงูุฏ ู `parseInt(undefined)` ุจุฑุงุจุฑ `NaN` ูโุดูุฏ ฺฉู ุจุงุนุซ ุฎุทุง ูโุดูุฏ.

**ุฑุงู ุญู:**
```javascript
const oldIndex = parseInt(active.id.split('-')[1]) || 0;
const newIndex = parseInt(over.id.split('-')[1]) || 0;
if (isNaN(oldIndex) || isNaN(newIndex)) return;
```

### 2. ุจุงฺฏ ูุดุงุจู ุฏุฑ Drag & Drop - TrainingPanel
**ูฺฉุงู:** `src/components/TrainingPanel.jsx:142-143`
**ูุดฺฉู:** ููุงู ูุดฺฉู ุจุงูุง ุฏุฑ TrainingPanel
**ุฑุงู ุญู:** ููุงู ุฑุงู ุญู ุจุงูุง

### 3. ุจุงฺฏ ุฏุฑ ูุญุงุณุจู ูุณุช ุฎุฑุฏ ููุชฺฏ
**ูฺฉุงู:** `src/components/DietPanel.jsx:160-173`
**ูุดฺฉู:** 
- ุงฺฏุฑ `activeUser.days` ุชุนุฑู ูุดุฏู ุจุงุดุฏุ `restDays` ููฺฉู ุงุณุช ููู ุดูุฏ
- ูุญุงุณุจู ููุท ุจุฑุง ฺฉ ููุชู ุงุณุช ู ุงฺฏุฑ ฺฉุงุฑุจุฑ ุจุฎูุงูุฏ ุจุฑุง ฺูุฏ ููุชู ูุญุงุณุจู ฺฉูุฏุ ุงูฺฉุงู ูุฏุงุฑุฏ

**ุฑุงู ุญู:**
```javascript
const trainingDays = parseInt(activeUser.days) || 3;
const restDays = Math.max(0, 7 - trainingDays); // ุฌููฺฏุฑ ุงุฒ ููู ุดุฏู
```

---

## ๐ ุจุงฺฏโูุง ููู (Important Bugs)

### 4. ูุดฺฉู ุฏุฑ Validation ูุฑูุฏโูุง
**ูฺฉุงู:** `src/components/DietPanel.jsx:119-120`
**ูุดฺฉู:** 
- ููุท ุจุฑุฑุณ ูโฺฉูุฏ ฺฉู `foodName` ู `amount` ูุฌูุฏ ุฏุงุดุชู ุจุงุดูุฏ
- ุจุฑุฑุณ ููโฺฉูุฏ ฺฉู `amount` ุนุฏุฏ ูุนุชุจุฑ ุจุงุดุฏ
- ุจุฑุฑุณ ููโฺฉูุฏ ฺฉู `info.b` ุตูุฑ ูุจุงุดุฏ (ุชูุณู ุจุฑ ุตูุฑ)

**ุฑุงู ุญู:**
```javascript
if (!foodName || !amount) return toast.error('ุบุฐุง ู ููุฏุงุฑ ุฑุง ูุงุฑุฏ ฺฉูุฏ');
const amountNum = parseFloat(amount);
if (isNaN(amountNum) || amountNum <= 0) return toast.error('ููุฏุงุฑ ุจุงุฏ ุนุฏุฏ ูุซุจุช ุจุงุดุฏ');
if (!info || !info.b || info.b === 0) return toast.error('ุงุทูุงุนุงุช ุบุฐุง ูุงูุนุชุจุฑ ุงุณุช');
const ratio = amountNum / info.b;
```

### 5. ูุดฺฉู ุฏุฑ ูุญุงุณุจู Body Fat ุจุง ูุฑููู Navy
**ูฺฉุงู:** `src/components/UserModal.jsx:135-142`
**ูุดฺฉู:**
- ุงฺฏุฑ `waist - neck <= 0` ุจุงุดุฏุ `Math.log10` ุฎุทุง ูโุฏูุฏ
- ุจุฑุง ุฎุงููโูุง ุงฺฏุฑ `hip` ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ูุญุงุณุจู ููโุดูุฏ

**ุฑุงู ุญู:**
```javascript
if (bodyFatPercent === 0 && waist > 0 && neck > 0 && h > 0) {
  const waistNeckDiff = waist - neck;
  if (waistNeckDiff > 0) {
    if (isMale) {
      bodyFatPercent = (495 / (1.0324 - 0.19077 * Math.log10(waistNeckDiff) + 0.15456 * Math.log10(h))) - 450;
    } else if (hip > 0) {
      const waistHipNeck = waist + hip - neck;
      if (waistHipNeck > 0) {
        bodyFatPercent = (495 / (1.29579 - 0.35004 * Math.log10(waistHipNeck) + 0.22100 * Math.log10(h))) - 450;
      }
    }
  }
}
```

### 6. ูุดฺฉู ุฏุฑ ูุญุงุณุจู ฺฉุงูุฑ ูุฏู ุจุฑุง ุฑูุฒ ุงุณุชุฑุงุญุช
**ูฺฉุงู:** `src/components/DietPanel.jsx:301-315`
**ูุดฺฉู:**
- ุฏุฑ ุฑูุฒ ุงุณุชุฑุงุญุชุ ฺฉุงูุฑ ูุฏู ููฺฉู ุงุณุช ฺฉูุชุฑ ุงุฒ BMR ุดูุฏ ฺฉู ุบุฑููุทู ุงุณุช
- ุจุฑุง `recomp` ุฏุฑ ุฑูุฒ ุงุณุชุฑุงุญุชุ ฺฉุงูุฑ ูุฏู ุชูุธู ูุดุฏู

**ุฑุงู ุญู:**
```javascript
case 'weight-loss': 
  targetCalories = Math.max(bmr, tdee - (isRestDay ? 400 : 500)); 
  break;
case 'recomp':
  targetCalories = isRestDay ? Math.max(bmr, tdee - 200) : tdee;
  break;
```

### 7. ูุดฺฉู ุฏุฑ PDF Generation - Page Break
**ูฺฉุงู:** `src/context/AppContext.jsx:484-507`
**ูุดฺฉู:**
- ุงฺฏุฑ ูุญุชูุง ุฎู ุทููุงู ุจุงุดุฏุ ููฺฉู ุงุณุช ุตูุญู ุงูู ุฎุงู ุจูุงูุฏ
- `pageHeightPx` ููฺฉู ุงุณุช ุฏูู ูุจุงุดุฏ

**ุฑุงู ุญู:** ุจุฑุฑุณ ุฏููโุชุฑ ุงุฑุชูุงุน ุตูุญู ู ุงุถุงูู ฺฉุฑุฏู margin

---

## ๐ก ูุดฺฉูุงุช ููุทู (Logical Issues)

### 8. ูุดฺฉู ุฏุฑ Migration ุฏุงุฏูโูุง ูุฏู
**ูฺฉุงู:** `src/context/AppContext.jsx:13-29`
**ูุดฺฉู:**
- ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุฏู `dietRest` ูุฏุงุดุชู ุจุงุดุฏุ ุจู ุขุฑุงู ุฎุงู ุชุจุฏู ูโุดูุฏ
- ุงูุง ุงฺฏุฑ ฺฉุงุฑุจุฑ ูุจูุงู ุฏุงุฏูโุง ุฏุฑ `diet` ุฏุงุดุชู ุจุงุดุฏุ ููฺฉู ุงุณุช ุจุฎูุงูุฏ ููุงู ุฑุง ุฏุฑ `dietRest` ูู ุฏุงุดุชู ุจุงุดุฏ

**ุฑุงู ุญู:** ุงุถุงูู ฺฉุฑุฏู ููุทู ุจุฑุง ฺฉูพ ุฎูุฏฺฉุงุฑ `diet` ุจู `dietRest` ุฏุฑ ุตูุฑุช ูุงุฒ

### 9. ูุดฺฉู ุฏุฑ ูุญุงุณุจู ูุงฺฉุฑููุง
**ูฺฉุงู:** `src/components/DietPanel.jsx:317-353`
**ูุดฺฉู:**
- ุฏุฑ ุจุฑุฎ ููุงุฑุฏุ ูุฌููุน ฺฉุงูุฑ ูุงฺฉุฑููุง ููฺฉู ุงุณุช ุจุง `targetCalories` ุจุฑุงุจุฑ ูุจุงุดุฏ
- ุจุฑุง `recomp` ุฏุฑ ุฑูุฒ ุงุณุชุฑุงุญุชุ ูุงฺฉุฑููุง ุชูุธู ูุดุฏู

**ุฑุงู ุญู:** ุงุถุงูู ฺฉุฑุฏู ููุทู ุจุฑุง `recomp` ุฏุฑ ุฑูุฒ ุงุณุชุฑุงุญุช

### 10. ูุดฺฉู ุฏุฑ ููุงุด ูุถุนุช ูุงู
**ูฺฉุงู:** `src/components/UserList.jsx:12-23`
**ูุดฺฉู:**
- ุงฺฏุฑ `startDate` ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏุ ููุดู "ูุงูุดุฎุต" ูุดุงู ูโุฏูุฏ
- ูุญุงุณุจู `daysLeft` ููฺฉู ุงุณุช ุจุฑุง ุชุงุฑุฎโูุง ฺฏุฐุดุชู ูุดฺฉู ุฏุงุดุชู ุจุงุดุฏ

**ุฑุงู ุญู:** ุจูุจูุฏ ููุทู ูุญุงุณุจู ู ููุงุด

---

## ๐ต ูุดฺฉูุงุช UI/UX

### 11. Console.log ุฏุฑ Production
**ูฺฉุงู:** `src/App.jsx:111-128`
**ูุดฺฉู:** `console.log` ุฏุฑ ฺฉุฏ production ุจุงู ูุงูุฏู ุงุณุช
**ุฑุงู ุญู:** ุญุฐู ุชูุงู `console.log` ูุง ุง ุงุณุชูุงุฏู ุงุฒ environment variable

### 12. ูุดฺฉู ุฏุฑ ููุงุด ุฎุทุงูุง
**ูฺฉุงู:** ุชูุงู ฺฉุงููพูููุชโูุง
**ูุดฺฉู:** ุจุฑุฎ ุฎุทุงูุง ููุท ุฏุฑ console ููุงุด ุฏุงุฏู ูโุดููุฏ ู ุจู ฺฉุงุฑุจุฑ ูุดุงู ุฏุงุฏู ููโุดููุฏ
**ุฑุงู ุญู:** ุงุณุชูุงุฏู ุงุฒ toast ุจุฑุง ููุงุด ุฎุทุงูุง ุจู ฺฉุงุฑุจุฑ

### 13. ูุดฺฉู ุฏุฑ Responsive Design
**ูฺฉุงู:** ุชูุงู ฺฉุงููพูููุชโูุง
**ูุดฺฉู:** ุจุฑุฎ ุจุฎุดโูุง ุฏุฑ ููุจุงู ุจู ุฏุฑุณุช ููุงุด ุฏุงุฏู ููโุดููุฏ
**ุฑุงู ุญู:** ุจูุจูุฏ responsive design

### 14. ูุดฺฉู ุฏุฑ Accessibility
**ูฺฉุงู:** ุชูุงู ฺฉุงููพูููุชโูุง
**ูุดฺฉู:** 
- ุจุฑุฎ ุฏฺฉููโูุง label ูุฏุงุฑูุฏ
- ุจุฑุฎ input ูุง label ูุฏุงุฑูุฏ
- ุฑูฺฏโูุง ููฺฉู ุงุณุช ุจุฑุง ุงูุฑุงุฏ ฺฉูุฑุฑูฺฏ ููุงุณุจ ูุจุงุดูุฏ

**ุฑุงู ุญู:** ุงุถุงูู ฺฉุฑุฏู aria-label ู ุจูุจูุฏ contrast

---

## ๐ข ูุดฺฉูุงุช ุนููฺฉุฑุฏ (Performance Issues)

### 15. ูุดฺฉู ุฏุฑ Re-render
**ูฺฉุงู:** `src/App.jsx:108`
**ูุดฺฉู:** ุงุณุชูุงุฏู ุงุฒ `key={`userlist-${users.length}`}` ุจุงุนุซ re-render ฺฉุงูู ูโุดูุฏ
**ุฑุงู ุญู:** ุงุณุชูุงุฏู ุงุฒ `key` ุจูุชุฑ ุง ุงุณุชูุงุฏู ุงุฒ `useMemo`

### 16. ูุดฺฉู ุฏุฑ localStorage
**ูฺฉุงู:** `src/context/AppContext.jsx:420-430`
**ูุดฺฉู:** ูุฑ ุจุงุฑ ฺฉู state ุชุบุฑ ูโฺฉูุฏุ ฺฉู ุฏุงุฏูโูุง ุฏุฑ localStorage ุฐุฎุฑู ูโุดููุฏ
**ุฑุงู ุญู:** ุงุณุชูุงุฏู ุงุฒ debounce ุจุฑุง ฺฉุงูุด ุชุนุฏุงุฏ write ูุง

---

## ๐ด ูุดฺฉูุงุช ุงููุช (Security Issues)

### 17. ูุดฺฉู ุฏุฑ XSS
**ูฺฉุงู:** `src/context/AppContext.jsx:generatePrintHTML`
**ูุดฺฉู:** ุฏุงุฏูโูุง ฺฉุงุฑุจุฑ ูุณุชููุงู ุฏุฑ HTML ูุฑุงุฑ ูโฺฏุฑูุฏ ุจุฏูู escape
**ุฑุงู ุญู:** ุงุณุชูุงุฏู ุงุฒ escape ุจุฑุง ุชูุงู ุฏุงุฏูโูุง ฺฉุงุฑุจุฑ

### 18. ูุดฺฉู ุฏุฑ Validation ูุฑูุฏโูุง
**ูฺฉุงู:** ุชูุงู ูุฑูโูุง
**ูุดฺฉู:** ุจุฑุฎ ูุฑูุฏโูุง validate ููโุดููุฏ
**ุฑุงู ุญู:** ุงุถุงูู ฺฉุฑุฏู validation ุจุฑุง ุชูุงู ูุฑูุฏโูุง

---

## ๐ฃ ูุดฺฉูุงุช ุนูู (Scientific Issues)

### 19. ูุดฺฉู ุฏุฑ ูุญุงุณุจู BMR
**ูฺฉุงู:** `src/components/UserModal.jsx:73-98`
**ูุดฺฉู:** 
- ุงฺฏุฑ `w`, `h`, ุง `a` ุตูุฑ ุจุงุดุฏุ BMR ุตูุฑ ูโุดูุฏ
- ูุงูฺฏูโฺฏุฑ ููฺฉู ุงุณุช ุฏูู ูุจุงุดุฏ

**ุฑุงู ุญู:** ุจุฑุฑุณ ุฏููโุชุฑ ูุฑูุฏโูุง ู ุงุณุชูุงุฏู ุงุฒ ูุฑูููโูุง ุฏููโุชุฑ

### 20. ูุดฺฉู ุฏุฑ ูุญุงุณุจู TDEE
**ูฺฉุงู:** `src/components/UserModal.jsx:100-107`
**ูุดฺฉู:** 
- `adjustedActivityFactor` ููฺฉู ุงุณุช ุจุฑุง ุจุฑุฎ ุงูุฑุงุฏ ููุงุณุจ ูุจุงุดุฏ
- ุจุฑุง ุงูุฑุงุฏ ุจุณุงุฑ ูุนุงู ุง ุจุณุงุฑ ฺฉูโุชุญุฑฺฉุ ููฺฉู ุงุณุช ุฏูู ูุจุงุดุฏ

**ุฑุงู ุญู:** ุงุณุชูุงุฏู ุงุฒ ูุฑูููโูุง ุฏููโุชุฑ ู ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฑุงุท ุฎุงุต

### 21. ูุดฺฉู ุฏุฑ ูุญุงุณุจู ูุงฺฉุฑููุง
**ูฺฉุงู:** `src/components/UserModal.jsx:168-208`
**ูุดฺฉู:**
- ุจุฑุง ุจุฑุฎ ุงูุฏุงูุ ูุณุจุช ูุงฺฉุฑููุง ููฺฉู ุงุณุช ููุงุณุจ ูุจุงุดุฏ
- ุจุฑุง ุงูุฑุงุฏ ุจุง ุดุฑุงุท ุฎุงุต (ูุซูุงู ุฏุงุจุช)ุ ูุงุฒ ุจู ุชูุธูุงุช ุฎุงุต ุงุณุช

**ุฑุงู ุญู:** ุงุถุงูู ฺฉุฑุฏู ฺฏุฒููโูุง ุจุดุชุฑ ุจุฑุง ุชูุธู ูุงฺฉุฑููุง

---

## ๐ ุฎูุงุตู

### ุจุงฺฏโูุง ุจุญุฑุงู: 3 ููุฑุฏ
### ุจุงฺฏโูุง ููู: 4 ููุฑุฏ
### ูุดฺฉูุงุช ููุทู: 3 ููุฑุฏ
### ูุดฺฉูุงุช UI/UX: 4 ููุฑุฏ
### ูุดฺฉูุงุช ุนููฺฉุฑุฏ: 2 ููุฑุฏ
### ูุดฺฉูุงุช ุงููุช: 2 ููุฑุฏ
### ูุดฺฉูุงุช ุนูู: 3 ููุฑุฏ

**ุฌูุน ฺฉู: 21 ููุฑุฏ**

---

## ๐ฏ ุงูููุชโุจูุฏ

### ุงูููุช 1 (ููุฑ):
1. ุจุงฺฏ Drag & Drop ุฏุฑ DietPanel ู TrainingPanel
2. ูุดฺฉู Validation ูุฑูุฏโูุง
3. ูุดฺฉู XSS ุฏุฑ PDF Generation

### ุงูููุช 2 (ููู):
4. ูุดฺฉู ุฏุฑ ูุญุงุณุจู Body Fat
5. ูุดฺฉู ุฏุฑ ูุญุงุณุจู ฺฉุงูุฑ ูุฏู ุจุฑุง ุฑูุฒ ุงุณุชุฑุงุญุช
6. ูุดฺฉู ุฏุฑ PDF Generation

### ุงูููุช 3 (ุจูุจูุฏ):
7. ุญุฐู console.log
8. ุจูุจูุฏ UI/UX
9. ุจูุจูุฏ Performance

### ุงูููุช 4 (ุงุฎุชุงุฑ):
10. ุจูุจูุฏ ูุญุงุณุจุงุช ุนูู
11. ุจูุจูุฏ Accessibility
12. ุจูุจูุฏ Responsive Design

